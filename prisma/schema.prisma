datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
}

generator client {
  provider = "prisma-client-js"
}

enum Event {
  all
  messageDelete
  messageBulkDelete
  messageUpdate
  channelCreate
  channelDelete
  channelUpdate
  channelPinsUpdate
  guildBanAdd
  guildBanRemove
  guildEmojiCreate
  guildEmojiRemove
  guildEmojiUpdate
  guildMemberAdd
  guildMemberRemove
  guildMemberUpdate
  roleCreate
  roleDelete
  roleUpdate
  stickerCreate
  stickerRemove
  stickerUpdate
  guildUpdate
}

model LogChannel {
  /// Guild Id
  guildId   BigInt   @map("guild_id")
  /// The Guild this log channel belongs to
  guild     Guild    @relation(fields: [guildId], references: [id])
  /// Channel id to send all logs.
  channelId BigInt   @map("channel_id")
  /// The array of the events on.
  /// if it is empty, it does not send any logs.
  events    Event[]  @default([])
  /// The date of registration of this channel in the database.
  createdAt DateTime @default(now()) @map("created_at")
  /// The date of the last update of this channel in the database.
  updatedAt DateTime @updatedAt @map("updated_at")

  @@id([guildId, channelId])
  @@map("log_channels")
}

enum Language {
  EN
  ES
  DE
}

model Guild {
  /// The id of the server
  id        BigInt       @id @unique
  /// The lang of the server
  lang      Language     @default(ES)
  /// The logs that are registered on the server
  logs      LogChannel[]
  /// The date of registration of this guild in the database.
  createdAt DateTime     @default(now()) @map("created_at")
  /// The date of the last update of this guild in the database.
  updatedAt DateTime     @updatedAt @map("updated_at")

  @@map("guilds")
}
